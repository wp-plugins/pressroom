jQuery(function(){function e(e,t){e.is(":checked")?(jQuery("."+t+" input").removeAttr("disabled"),jQuery("."+t+" select").removeAttr("disabled"),jQuery("."+t+" button").removeAttr("disabled"),jQuery("."+t+" h3, ."+t+" label").css("color","#222")):(jQuery("."+t+" input").attr("disabled","disabled"),jQuery("."+t+" select").attr("disabled","disabled"),jQuery("."+t+" button").attr("disabled","disabled"),jQuery("."+t+" h3, ."+t+" label").css("color","#ddd"),e.removeAttr("disabled"),e.parent().parent().find("label").css("color","#222"))}function t(e){var t=e.val();switch(t){case"ftp":case"sftp":jQuery('.web_metabox input[type="text"], .web_metabox input[type="password"]').removeAttr("disabled"),jQuery('.web_metabox input[name="_pr_local_path"]').attr("disabled","disabled"),jQuery("#test-connection").removeAttr("disabled");break;case"local":jQuery('.web_metabox input[type="text"], .web_metabox input[type="password"]').attr("disabled","disabled"),jQuery('.web_metabox input[name="_pr_local_path"]').removeAttr("disabled"),jQuery("#test-connection").attr("disabled","disabled")}}jQuery(".pr-color-picker").wpColorPicker(),jQuery(".chosen-select").length&&jQuery(".chosen-select").chosen(),jQuery("#_pr_date").datepicker({dateFormat:"yy-mm-dd"});var r=jQuery("#_pr_prefix_bundle_id"),a=jQuery("#_pr_subscription_prefix");jQuery("#_pr_prefix_bundle_id").keyup(function(){jQuery('#_pr_single_edition_prefix, #_pr_subscription_prefix, .pr_repeater input[type="text"]').trigger("keyup")}),jQuery("#_pr_single_edition_prefix, #_pr_subscription_prefix").keyup(function(){var e=jQuery(this).next();e.html(r.val()+"."+jQuery(this).val()),jQuery('.pr_repeater input[type="text"]').trigger("keyup")}),jQuery(".form-table").delegate('.pr_repeater input[type="text"]',"keyup",function(){var e=jQuery(this).parent().find(".repeater-completer");e.html(r.val()+"."+a.val()+"."+jQuery(this).val())}),jQuery("#_pr_prefix_bundle_id").trigger("keyup"),jQuery("#add-field").click(function(e){e.preventDefault();var t=jQuery("#pr_repeater").clone(),n='<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAARBAMAAAA1VnEDAAAAA3NCSVQICAjb4U/gAAAACXBIWXMAAAF3AAABdwE7iaVvAAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAAAA9QTFRF////AAAAAAAAAAAAAAAAUTtq8AAAAAR0Uk5TADVCUDgXPZIAAAAaSURBVAhbY2CgKVA2BgIjCJvRBQwEMGVoBQCxXAPsAZwyyQAAAABJRU5ErkJggg60a8c977b5851eb7a101a51c617fd8ad"/>',i=jQuery(".pr_repeater").last().data("index");t.find("#add-field").attr("class","remove-field"),t.find("#add-field").attr("id","remove-field"),t.find("#remove-field").html(n);var p=jQuery(".pr_repeater").parent();t.data("index",parseInt(i)+1),t.find('input[type="text"]').val("");var s=t.find('input[type="text"]').attr("name"),u=t.find('input[type="radio"]').attr("name");t.find('input[type="text"]').attr("name",s.replace("[0]","["+(parseInt(i)+1)+"]")),t.find('input[type="radio"]').attr("name",u.replace("[0]","["+(parseInt(i)+1)+"]")),t.find(".repeater-completer").html(r.val()+"."+a.val()),t.appendTo(p)}),jQuery(".form-table").delegate(".remove-field","click",function(e){e.preventDefault(),jQuery(this).parent().remove()}),jQuery("#pressroom_metabox").removeClass("postbox"),jQuery(".tabbed").css("display","none"),jQuery(".hpub_metabox").css("display","table-row"),jQuery(".basic_metabox").css("display","table-row"),jQuery(".flatplan").css("display","table-row"),jQuery(".nav-tab").click(function(e){e.preventDefault(),jQuery(".nav-tab").each(function(){jQuery(this).removeClass("nav-tab-active")});var t=jQuery(this).data("tab");jQuery(this).addClass("nav-tab-active"),jQuery(".tabbed").css("display","none"),jQuery("."+t).css("display","table-row")}),jQuery(".remove-file").click(function(e){if(e.preventDefault(),confirm("Do you really want to delete this file?")){var t=jQuery(this).data("field"),r=jQuery(this).data("term"),a=jQuery(this).data("attachment"),n=jQuery(this),i={field:t,term_id:r,attach_id:a,action:"remove_upload_file"};jQuery.post(ajaxurl,i,function(e){e?(n.parent().find("img").css("display","none"),n.css("display","none")):alert("Error. Please retry")})}}),jQuery("#test-connection").click(function(e){e.preventDefault(),jQuery("#connection-result").html('<div class="spinner"></div>'),jQuery("#connection-result").css("display","block"),jQuery("#connection-result .spinner").css("display","inline-block").css("float","none");var t=jQuery('input[name="_pr_ftp_server[0]"]').val(),r=jQuery('input[name="_pr_ftp_server[1]"]').val(),a=jQuery('input[name="_pr_ftp_destination_path"]').val(),n=jQuery('input[name="_pr_ftp_user"]').val(),i=jQuery('input[name="_pr_ftp_password"]').val(),p=jQuery('input[name="_pr_ftp_protocol"]:checked').val(),s={server:t,port:r,base:a,user:n,password:i,protocol:p,action:"test_ftp_connection"};jQuery.post(ajaxurl,s,function(e){e&&(jQuery("#connection-result").html(e.data.message),jQuery("#connection-result").removeClass("connection-result-success connection-result-failure"),jQuery("#connection-result").addClass("connection-result connection-result-"+e.data.class))})});var n=jQuery("#_pr_web_override_eproject"),i=jQuery("#_pr_hpub_override_eproject"),p=jQuery("#_pr_adps_override_eproject");n.click(function(){e(jQuery(this),"web_metabox")}),i.click(function(){e(jQuery(this),"hpub")}),p.click(function(){e(jQuery(this),"adps_metabox")}),n.length&&e(n,"web_metabox"),i.length&&e(i,"hpub"),p.length&&e(p,"adps_metabox"),t(jQuery('input[name="_pr_ftp_protocol"]:checked')),jQuery('input[name="_pr_ftp_protocol"]').live("change",function(){t(jQuery(this))})});
