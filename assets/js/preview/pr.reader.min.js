function fixPagesHeight(){$(".swiper-pages").css({height:$("#sg-gen-container").height()});prSwiper.resizeFix()}function getNotLoadedSlide(e,t,n,r){if(n==r){return false}var i=t=="next"?e.next():e.prev();if(!i.length){return false}if(i.data("status")!="loaded"){return i}else{getNotLoadedSlide(i,t,n+1,r)}}var prSwiper;$(function(){var e=$("#reader"),t=e.data("conpages"),n=$(".circle--left").hide(),r=$(".circle--right").hide();$.fn.lazyLoad=function(t,n,r){var i=$(this),s=i.data("status");if(s!="loaded"){return $.get(e.data("url"),{post_id:i.data("post"),edition_id:e.data("edition"),package_type:e.data("package-type"),action:"preview_draw_page",pr_no_theme:true},function(e){if(e){var t=$("<iframe>",{src:e,height:"100%",width:"100%",frameborder:0});t.load(function(){var e=t.contents().find("head");e.append($("<style>body{-webkit-touch-callout: none;-webkit-user-select: none;-khtml-user-select: none;-moz-user-select: none;-ms-user-select: none;user-select: none;}</style>"))});i.data("status","loaded").children(".spinner").replaceWith(t).hide().fadeIn("slow")}}).then(function(){if(t<n-1){$n=r=="prev"?i.prev():i.next();if($n.length){$n.lazyLoad(t+1,n,r)}}})}else{if(t<n-1){$n=r=="prev"?i.prev():i.next();if($n.length){$n.lazyLoad(t+1,n,r)}}}};prSwiper=new Swiper(".swiper-pages",{mode:"horizontal",pagination:".dots",loop:false,simulateTouch:false,grabCursor:false,roundLengths:true,calculateHeight:false,paginationClickable:true,keyboardControl:true,hashNav:true,speed:500,onFirstInit:function(e){var n=window.location.hash;$item=$(n);if(!$item.length){$item=$(".swiper-slide:first");$next=$item.next();if($next.length){r.show()}$item.lazyLoad(0,t,"next")}},onSlideChangeStart:function(e,i){if(e.activeIndex==e.slides.length-1){r.hide();n.show()}else if(e.activeIndex==0){n.hide();r.show()}else{r.show();n.show()}$item=$(e.activeSlide());if(i=="to"){$item.lazyLoad(0,1,"next");$prev=$item.prev(),$next=$item.next();if($next.length){r.show();$next.lazyLoad(0,t,"next")}if($prev.length){n.show();$prev.lazyLoad(0,t,"prev")}}else{$next=getNotLoadedSlide($item,i,0,t-1);if($next){$next.lazyLoad(0,t,i)}}},onSlideChangeEnd:function(e){}});n.on("click",function(e){e.preventDefault();prSwiper.swipePrev()});r.on("click",function(e){e.preventDefault();prSwiper.swipeNext()});$(window).on("hashchange",function(e){var t=document.location.hash;if(t.match("^#toc-")){t=t.replace("#toc-","item-");if(!t)return;for(var n=0;n<prSwiper.slides.length;n++){var r=prSwiper.slides[n];var i=r.data("hash");if(i===t&&r.getData("looped")!==true){var s=r.index();if(prSwiper.params.loop)s=s-prSwiper.loopedSlides;prSwiper.swipeTo(s,prSwiper.speed)}}}});fixPagesHeight()})
